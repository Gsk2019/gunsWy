@layout("/common/_container.html",{bg:"bg-white",js:["/assets/modular/business/course/course_add.js"]}){
<style type="text/css">
    .layui-upload-img {
        width: 92px;
        height: 92px;
        margin: 0 10px 10px 0;
    }
    .layui-input-block {
        margin-top: 4px;
    }
</style>
<form id="courseForm" lay-filter="courseForm" class="layui-form model-form">


    <div class="layui-form-item">
        <label class="layui-form-label">课程名称<span style="color: red;">*</span></label>
        <div class="layui-input-block">
            <input name="courseName" placeholder="请输入课程名称" type="text" class="layui-input" lay-verify="required" required/>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">课程类型<span style="color: red;">*</span></label>
        <div class="layui-input-block">
            <select name="courseType" lay-verify="required">
                <option value="">课程类型</option>
                <option value="1">精品班</option>
                <option value="2">管理班</option>
                <option value="3">金融班</option>
                <option value="4">地产班</option>
                <option value="5">其它班</option>
            </select>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">课程封面<span style="color: red;">*</span></label>
        <div class="layui-upload">
            <button type="button" class="layui-btn" id="courseImageBtn">上传图片</button><br>
            <div class="layui-input-block">
                <img class="layui-upload-img" id="courseImageImg">
                <p id="imageText"></p>
            </div>
        </div>
        <input type="hidden" name="courseImage" id="courseImage"  value="">
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">课程价格<span style="color: red;">*</span></label>
        <div class="layui-input-block">
            <input name="price" placeholder="请输入课程价格" type="text" class="layui-input" lay-verify="required" required/>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">开课时间<span style="color: red;">*</span></label>
        <div class="layui-input-block">
            <input name="startTime" placeholder="请输入开课时间" type="text" class="layui-input" lay-verify="required" required/>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">课程学制<span style="color: red;">*</span></label>
        <div class="layui-input-block">
            <input name="courseLength" placeholder="请输入课程学制" type="text" class="layui-input" lay-verify="required" required/>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">详情图片<span style="color: red;">*</span></label>
        <div class="layui-upload">
            <button type="button" class="layui-btn" id="descImagesBtn">上传图片</button><span style="color: red">用于小程序端展示详情，请上传宽度800左右的图片，高度不限</span>
            <div class="layui-input-block">
                <img class="layui-upload-img" id="descImagesImg">
                <p id="descImagesText"></p>
            </div>
        </div>
        <input type="hidden" name="descImages" id="descImages"  value="">
    </div>


    <div class="layui-form-item">
        <label class="layui-form-label">招生简章<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <button type="button" class="layui-btn" id="descUrlButton">
                <i class="layui-icon">&#xe67c;</i>选择文件
            </button>
        </div>
        <div class="layui-form-mid layui-word-aux" id="descUrlDiv"></div>
        <input type="hidden" name="descUrl" id="descUrl"  value="">
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">报名表<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <button type="button" class="layui-btn" id="joinUrlButton">
                <i class="layui-icon">&#xe67c;</i>选择文件
            </button>
        </div>
        <div class="layui-form-mid layui-word-aux" id="joinUrlDiv"></div>
        <input type="hidden" name="joinUrl" id="joinUrl"  value="">
    </div>

<!--    <div class="layui-form-item">
        <label class="layui-form-label">课程详情<span style="color: red;">*</span></label>
        <div class="layui-input-block">
            <textarea id="courseDesc" style="display: none;" ></textarea>
        </div>
    </div>-->

    <div class="layui-form-item text-right">
        <button class="layui-btn layui-btn-primary" type="button" ew-event="closeDialog">取消</button>
        <button class="layui-btn" lay-filter="btnSubmit" lay-submit>保存</button>
    </div>
</form>
@}
<script>
    layui.use('upload', function(){
        var upload = layui.upload;
        //执行实例
        var uploadInst = upload.render({
            elem: '#descUrlButton' //绑定元素
            ,url: '/file/upload?type=2' //上传接口
            ,accept: 'file' //普通文件
            ,exts: 'doc|docx' //只允许上传压缩文件
            ,done: function(res){
                if(res.code==0){
                    $('#descUrl').val(res.src);
                    $('#descUrlDiv').html(res.name);
                    layer.msg('文件上传成功')
                }else{
                    layer.msg('上传失败')
                }
            }
            ,error: function(){
                layer.msg('上传失败')
            }
        });
    });
    layui.use('upload', function(){
        var upload = layui.upload;
        //执行实例
        var uploadInst = upload.render({
            elem: '#joinUrlButton'
            ,url: '/file/upload?type=3'
            ,accept: 'file'
            ,exts: 'doc|docx'
            ,done: function(res){
                if(res.code==0){
                    $('#joinUrl').val(res.src);
                    $('#joinUrlDiv').html(res.name);
                    layer.msg('文件上传成功')
                }else{
                    layer.msg('上传失败')
                }
            }
            ,error: function(){
                layer.msg('上传失败')
            }
        });
    });

    layui.use('upload', function() {
        var $ = layui.jquery
            , upload = layui.upload;
        //普通图片上传
        var uploadInst = upload.render({
            elem: '#courseImageBtn'
            , url: '/file/upload'
            , before: function (obj) {
                //预读本地文件示例，不支持ie8
                obj.preview(function (index, file, result) {
                    $('#courseImageImg').attr('src', result); //图片链接（base64）
                });
            }
            , done: function (res) {
                //如果上传失败
                if (res.code != 0) {
                    return layer.msg('上传失败');
                }
                //上传成功
                $('#courseImage').val(res.src);
                return layer.msg('图片上传成功');
            }
            , error: function () {
                //演示失败状态，并实现重传
                var imageText = $('#imageText');
                imageText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                imageText.find('.demo-reload').on('click', function () {
                    uploadInst.upload();
                });
            }
        });
    })

    //小程序详情图片上传
    layui.use('upload', function() {
        var $ = layui.jquery
            , upload = layui.upload;

        var uploadInst = upload.render({
            elem: '#descImagesBtn'
            , url: '/file/upload?type=4'
            , before: function (obj) {
                //预读本地文件示例，不支持ie8
                obj.preview(function (index, file, result) {
                    $('#descImagesImg').attr('src', result); //图片链接（base64）
                });
            }
            , done: function (res) {
                //如果上传失败
                if (res.code != 0) {
                    return layer.msg('上传失败');
                }
                //上传成功
                $('#descImages').val(res.src);
                return layer.msg('图片上传成功');
            }
            , error: function () {
                //演示失败状态，并实现重传
                var imageText = $('#descImagesText');
                imageText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                imageText.find('.demo-reload').on('click', function () {
                    uploadInst.upload();
                });
            }
        });
    })


 /*   layui.use('layedit', function(){
        var layedit = layui.layedit;
        layedit.set({
            uploadImage: {
                url:Feng.ctxPath + '/file/layedit/upload', //接口url
                type: 'post' //默认post
            }
        });
        var index=layedit.build('courseDesc',{
            height: 380 //设置编辑器高度
        }); //建立编辑器
        layedit.sync(index)
    });*/

</script>